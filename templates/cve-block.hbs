<div class="d-flex align-items-center justify-content-end copy-btn-container">
  <button
          class="btn copy-btn p-action"
    {{action "copyData"}}
          title="Copy Information to Clipboard"
  >
    {{fa-icon icon="clipboard" fixedWidth=true}}
  </button>
  <div class="copy-success-message {{if showCopyMessage 'visible' 'hidden'}}">
    {{fa-icon icon="check" fixedWidth=true class="copy-success-icon"}}
    Copied Information.
  </div>
</div>
<div id={{concat "cve-search-container-" uniqueIdPrefix}}>
  <a href="https://nvd.nist.gov/vuln/detail/{{block.entity.value}}">View CVE Details on NIST {{fa-icon icon="external-link-square" class="external-link-icon"}}</a>

  <h1 class="p-title">{{fa-icon "info-circle" fixedWidth=true}} Summary</h1>
  <div>
    <span class="p-key">Modified:</span>
    <span class="p-value">{{moment-time details.Modified}}</span>
  </div>
  <div>
    <span class="p-key">Published:</span>
    <span class="p-value">{{moment-time details.Published}}</span>
  </div>
  <div>
    <span class="p-key">Assigner:</span>
    <span class="p-value">{{details.assigner}}</span>
  </div>
  <div>
    <span class="p-key">CWE:</span>
    <span class="p-value">{{details.cwe}}
      {{#unless (eq cweNumber -1)}}
        <a href="https://cwe.mitre.org/data/definitions/{{cweNumber}}.html" class="ml-1">(View on MITRE {{fa-icon icon="external-link-square" class="external-link-icon"}})</a>
      {{/unless}}
      </span>
  </div>

  <div class="oval">
      {{#if details.oval}}
        {{#each details.oval as |oval|}}
            {{oval.description}}
        {{/each}}
      {{else if details.summary}}
          <div class="summary">
            {{details.summary}}
          </div>
      {{/if}}
  </div>

  <h1 class="p-title">{{fa-icon icon="star" fixedWidth=true}} CVSS</h1>
  {{#if (or details.cvss details.cvss-time details.cvss-vector)}}
    {{#if details.cvss}}
      <div>
        <span class="p-key">CVSS Score::</span>
        <span class="p-value">{{details.cvss}}</span>
      </div>
    {{/if}}
    {{#if details.cvss-time}}
      <div>
        <span class="p-key">CVSS Time::</span>
        <span class="p-value">{{details.cvss-time}}</span>
      </div>
    {{/if}}
    {{#if details.cvss-vector}}
      <div>
        <span class="p-key">CVSS Vector::</span>
        <span class="p-value">{{details.cvss-vector}}</span>
      </div>
    {{/if}}
  {{else}}
    <span class="p-footnote">CVSS data not available</span>
  {{/if}}

  <h1 class="p-title">{{fa-icon icon="usb-drive" fixedWidth=true}} Access</h1>
  {{#if (or details.access.authentication details.access.complexity details.access.vector)}}
    {{#if details.access.authentication}}
      <div>
        <span class="p-key">Authentication:</span>
        <span class="p-value">{{details.access.authentication}}</span>
      </div>
    {{/if}}
    {{#if details.access.complexity}}
      <div>
        <span class="p-key">Complexity:</span>
        <span class="p-value">{{details.access.complexity}}</span>
      </div>
    {{/if}}
    {{#if details.access.vector}}
      <div>
        <span class="p-key">Vector:</span>
        <span class="p-value">{{details.access.vector}}</span>
      </div>
    {{/if}}
  {{else}}
    <span class="p-footnote">Access data not available</span>
  {{/if}}

  <h1 class="p-title">{{fa-icon icon="hammer" fixedWidth=true}} Impact</h1>
  {{#if (or details.impact.availability details.impact.confidentiality details.impact.integrity)}}
      {{#if details.impact.availability}}
        <div>
          <span class="p-key">Availability:</span>
          <span class="p-value">{{details.impact.availability}}</span>
        </div>
      {{/if}}
      {{#if details.impact.confidentiality}}
          <div>
            <span class="p-key">Confidentiality:</span>
            <span class="p-value">{{details.impact.confidentiality}}</span>
          </div>
      {{/if}}
      {{#if details.impact.integrity}}
          <div>
            <span class="p-key">Integrity:</span>
            <span class="p-value">{{details.impact.integrity}}</span>
          </div>
      {{/if}}
  {{else}}
    <span class="p-footnote">Impact data not available</span>
  {{/if}}

  <h1 class="p-title">{{fa-icon icon="dagger" fixedWidth=true}} MITRE Attack Pattern List (CAPEC)</h1>
  {{#if (gt details.capec.length 0)}}
    <table class="table table-condensed table-striped">
      <tbody>
      {{#each details.capec as |capec|}}
        <tr>
          <td><a href="https://capec.mitre.org/data/definitions/{{capec.id}}.html" class="p-link p-block"> {{capec.name}} {{fa-icon "external-link-square" class="external-link-icon"}}</a></td>
        </tr>
      {{/each}}
      </tbody>
    </table>
  {{else}}
    <span class="p-footnote">CAPEC data not available</span>
  {{/if}}

  <h1 class="p-title">{{fa-icon icon="browser" fixedWidth=true}} External References</h1>
  <table class="table table-condensed table-striped">
    <tbody>
    {{#each details.references as |ref|}}
      <tr>
        <td><a href="{{ref}}" class="p-link p-block"> {{ref}} {{fa-icon "external-link-square" class="external-link-icon"}}</a></td>
      </tr>
    {{/each}}
    </tbody>
  </table>
</div>